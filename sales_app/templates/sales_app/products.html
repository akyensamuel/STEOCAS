{% extends "core/base.html" %}
{% load static %}
{% block content %}
<div class="max-w-4xl mx-auto mt-10 p-8 bg-white dark:bg-gray-900 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700">
    <div class="mb-6 flex items-center justify-between">
        <input id="productSearch" type="text" placeholder="Search products..." class="w-1/2 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 dark:bg-gray-800 dark:text-gray-100" />
    </div>
    <h2 class="text-3xl font-extrabold mb-8 text-gray-900 dark:text-gray-100 flex items-center gap-2">
        <svg class="w-8 h-8 text-green-600 mr-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M3 7h18M3 12h18M3 17h18"/></svg>
        Products & Prices
    </h2>
    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700 mb-8 rounded-lg overflow-hidden shadow">
        <thead class="bg-gray-100 dark:bg-gray-800">
            <tr>
                <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700 dark:text-gray-300 uppercase">Name</th>
                <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700 dark:text-gray-300 uppercase">Unit Price</th>
                <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700 dark:text-gray-300 uppercase">Stock</th>
                <th class="px-6 py-3"></th>
            </tr>
        </thead>
        <tbody id="productsTableBody">
            {% for product in products %}
            <tr class="bg-white dark:bg-gray-900 border-b dark:border-gray-800 hover:bg-gray-50 dark:hover:bg-gray-800 transition product-row">
                <td class="px-6 py-4 font-medium text-gray-900 dark:text-gray-100 product-name">{{ product.name }}</td>
                <td class="px-6 py-4 text-green-700 dark:text-green-400 font-semibold">${{ product.price }}</td>
                <td class="px-6 py-4 font-semibold">
                    <span class="product-stock {% if product.stock < 50 %}text-red-600 dark:text-red-400 font-bold animate-pulse{% else %}text-green-700 dark:text-green-400{% endif %}">
                        {{ product.stock }}
                    </span>
                    {% if product.stock < 50 %}
                        <span class="ml-2 text-xs bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-200 px-2 py-1 rounded">Low Stock!</span>
                    {% endif %}
                </td>
                <td class="px-6 py-4 text-right flex gap-2 justify-end">
                    <a href="{% url 'edit_product' product.id %}" class="inline-block px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-xs font-semibold shadow">Edit</a>
                    <a href="{% url 'delete_product' product.id %}" class="inline-block px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg text-xs font-semibold shadow">Delete</a>
                </td>
            </tr>
            {% empty %}
            <tr><td colspan="3" class="px-6 py-4 text-center text-gray-500 dark:text-gray-400">No products found.</td></tr>
            {% endfor %}
        </tbody>
    </table>
    <div class="flex justify-end">
        <a href="{% url 'add_product' %}" class="inline-block px-4 py-2 bg-green-700 hover:bg-green-800 text-white font-medium rounded-lg text-xs shadow transition whitespace-nowrap">+ Add Product</a>
    </div>
    <script src="{% static 'sales_app/js/products.js' %}"></script>
</div>
{% endblock %}
